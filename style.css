/* =========================
   RESET & BASE
   ========================= */
:root{
  --bg: #0b1220;
  --bg-soft: #0f1a2e;
  --surface: #121b31;
  --surface-2: #16213f;
  --card: rgba(255,255,255,0.06);
  --card-hover: rgba(255,255,255,0.09);
  --muted: #a9b3c7;
  --text: #eaf0ff;

  --primary: #3da5ff;
  --primary-600: #2d8fe0;
  --primary-700: #1f73ba;
  --accent: #73e0ff;

  --success: #29c78c;
  --warning: #ffb200;
  --danger: #ff6363;

  --chip-bg: rgba(255,255,255,0.08);
  --chip-text: #dbe5ff;

  --shadow-1: 0 8px 30px rgba(0,0,0,.25);
  --shadow-2: 0 10px 40px rgba(0,0,0,.35);
  --radius: 16px;
  --radius-lg: 20px;

  --grid-gap: 16px;
  --container: 1200px;
  --blur: saturate(140%) blur(10px);

  --chart-grid: rgba(255,255,255,.12);
  --chart-text: #eaf0ff;
}

/* Themes */
body[data-theme="blue"]{
  --primary:#3da5ff; --accent:#73e0ff;
  --bg:#0b1220; --bg-soft:#0f1a2e; --surface:#121b31; --surface-2:#16213f;
}
body[data-theme="purple"]{
  --primary:#8a7dff; --accent:#c7b8ff;
  --bg:#0f0d1a; --bg-soft:#15132a; --surface:#1b1840; --surface-2:#211e52;
}
body[data-theme="dark"]{
  --primary:#8bd3ff; --accent:#a9f0ff;
  --bg:#090a0f; --bg-soft:#0f1118; --surface:#131623; --surface-2:#171a2b;
}
body[data-theme="pastel"]{
  --primary:#6fb1ff; --accent:#a8d8ff;
  --bg:#0e1726; --bg-soft:#101b2f; --surface:#14203a; --surface-2:#182548;
}

*,*::before,*::after{ box-sizing:border-box; }
html,body{ height:100%; }
body{
  margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text); background: radial-gradient(1200px 800px at 80% -10%, rgba(61,165,255,.25), transparent 60%),
             radial-gradient(1000px 600px at 10% -20%, rgba(115,224,255,.18), transparent 65%),
             linear-gradient(180deg, var(--bg), var(--bg-soft) 70%);
  line-height:1.55;
}
img{ max-width:100%; display:block; }
button{ font:inherit; color:inherit; background:none; border:0; cursor:pointer; }
input{ font:inherit; color:inherit; }

/* =========================
   CONTAINERS
   ========================= */
.container{ width:min(100%, var(--container)); margin-inline:auto; padding: 0 20px; }

/* =========================
   HEADER
   ========================= */
.app-header{
  position:sticky; top:0; z-index:40;
  backdrop-filter: var(--blur);
  background: linear-gradient(180deg, rgba(0,0,0,.45), rgba(0,0,0,.25));
  border-bottom:1px solid rgba(255,255,255,.08);
}
.header-inner{
  display:grid; grid-template-columns: auto 1fr; gap:20px; align-items:center; padding:14px 0;
}
.brand{ display:flex; align-items:center; gap:10px; }
.logo{ margin:0; font-size:20px; letter-spacing:.2px; }

.searchbar{
  display:flex; gap:10px; align-items:center; justify-content:flex-end; flex-wrap:wrap;
}
.searchbar input{
  min-width:280px; flex:1 1 280px;
  background: rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  border-radius: 12px; padding: 10px 12px;
  outline: none;
}
.searchbar input::placeholder{ color: rgba(234,240,255,.55); }

.tabs-nav{
  grid-column: 1 / -1;
  display:flex; flex-wrap:wrap; gap:8px; padding-bottom:10px;
}
.tab-btn{
  padding:8px 14px; border-radius:12px; background:transparent; color:var(--text);
  border:1px solid transparent; transition:.2s ease;
}
.tab-btn:is(:hover,:focus){ background:rgba(255,255,255,.08); }
.tab-btn.is-active{ background: linear-gradient(180deg, var(--primary), var(--primary-700)); border-color: transparent; color:#061020; box-shadow: var(--shadow-1); }

/* mobile quick */
.mobile-quick{ padding: 10px 20px 14px; border-top:1px solid rgba(255,255,255,.06); display:none; }
.mobile-quick .mobile-row{ display:flex; gap:8px; }
.mobile-quick input{
  flex:1; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
  border-radius:12px; padding:10px 12px;
}
.chips{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
.chips .chip{
  background: var(--chip-bg); color:var(--chip-text); padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.08);
}

/* Buttons */
.btn{
  --bg: rgba(255,255,255,.08);
  --bd: rgba(255,255,255,.12);
  padding:10px 12px; border-radius:12px; background:var(--bg); border:1px solid var(--bd);
  transition:.2s ease; white-space:nowrap;
}
.btn:is(:hover,:focus){ transform: translateY(-1px); background: rgba(255,255,255,.12); }
.btn.primary{ background: linear-gradient(180deg, var(--primary), var(--primary-700)); color:#061020; border:0; box-shadow: var(--shadow-1); }
.btn.ghost{ background: rgba(255,255,255,.06); }
.btn.icon{ width:40px; height:40px; display:grid; place-items:center; }
.i{ display:inline-block; width:18px; height:18px; background: currentColor; mask: no-repeat center / contain; -webkit-mask: no-repeat center / contain; }
.i-hamburger{ mask-image: url('data:image/svg+xml;utf8,<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><g fill="%23fff"><rect x="3" y="6" width="18" height="2" rx="1"/><rect x="3" y="11" width="18" height="2" rx="1"/><rect x="3" y="16" width="18" height="2" rx="1"/></g></svg>'); }
.i-close{ mask-image: url('data:image/svg+xml;utf8,<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path fill="%23fff" d="M6.2 4.8 4.8 6.2 10.6 12l-5.8 5.8 1.4 1.4L12 13.4l5.8 5.8 1.4-1.4L13.4 12l5.8-5.8-1.4-1.4L12 10.6z"/></svg>'); }

/* Alert banner */
.alert-banner{
  display:none; align-items:center; gap:10px; justify-content:center;
  padding:10px 14px; background: linear-gradient(180deg, rgba(255,178,0,.25), rgba(255,178,0,.15));
  border-top:1px solid rgba(255,255,255,.08); border-bottom:1px solid rgba(255,255,255,.08);
}
.alert-banner.danger{ background: linear-gradient(180deg, rgba(255,99,99,.28), rgba(255,99,99,.15)); }
.alert-banner.show{ display:flex; }

/* =========================
   DRAWER (MOBILE NAV)
   ========================= */
.drawer{
  position: fixed; inset:0 auto 0 0; width: 86vw; max-width: 420px; background: rgba(6,12,24,.92);
  backdrop-filter: var(--blur); transform: translateX(-100%); transition: .3s ease; z-index: 60;
  border-right:1px solid rgba(255,255,255,.1);
}
.drawer.open{ transform: translateX(0); }
.drawer-header{ display:flex; align-items:center; justify-content:space-between; padding:14px 16px; border-bottom:1px solid rgba(255,255,255,.08); }
.drawer-search{ padding:14px 16px; display:grid; gap:10px; }
.drawer-search input{
  background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
  border-radius:12px; padding:10px 12px;
}
.drawer-search .row{ display:flex; gap:8px; }
.drawer-tabs{ display:grid; gap:8px; padding: 6px 12px 16px; }
.drawer-tab{
  text-align:left; padding:10px 12px; border-radius:12px; background: rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.08);
}
.drawer-tab:hover{ background: rgba(255,255,255,.08); }
.drawer-favorites{ padding: 6px 16px 18px; }
.drawer-favorites h3{ margin:10px 0; font-size:14px; color:var(--muted); }

/* =========================
   MAIN / TABS
   ========================= */
.app-main{ padding: 22px 0 40px; }
.tab-panel{ display:none; animation: fadeUp .35s ease both; }
.tab-panel.is-active{ display:block; }
.section-head{
  display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:14px;
}
.section-head .head-actions{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
.muted{ color:var(--muted); font-size:13px; }

/* Segmented controls */
.segmented{ background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:999px; padding:4px; display:flex; gap:4px; }
.seg{ padding:8px 12px; border-radius:999px; }
.seg.is-active{ background: linear-gradient(180deg, var(--primary), var(--primary-700)); color:#061020; }

/* =========================
   HERO (CURRENT)
   ========================= */
.hero{
  display:flex; align-items:flex-start; justify-content:space-between; gap:16px; margin-bottom:16px; flex-wrap:wrap;
}
.hero-primary{ display:grid; gap:6px; }
.hero-city{ margin:0; font-size:28px; line-height:1.2; }
.hero-sub{ color:var(--muted); display:flex; gap:8px; align-items:center; }
.hero-actions{ display:flex; gap:8px; }

/* Metrics grid */
.grid{ display:grid; gap: var(--grid-gap); }
.metrics{
  grid-template-columns: repeat(4, minmax(0,1fr));
}
.cards-4{ grid-template-columns: repeat(4, minmax(0,1fr)); }
.cards-3{ grid-template-columns: repeat(3, minmax(0,1fr)); }

/* Card */
.card, .metric-card, .news-col{
  background: var(--card); border:1px solid rgba(255,255,255,.08); border-radius: var(--radius);
  box-shadow: var(--shadow-1); padding:14px; transition:.2s ease;
  overflow:hidden; /* chống phần tử con tràn ra (đặc biệt là canvas/tooltip) */
}
.card:hover, .metric-card:hover, .news-col:hover{ background: var(--card-hover); transform: translateY(-1px); }
.metric-title{ color:var(--muted); font-size:13px; margin-bottom:6px; }
.metric-value{ font-size:26px; font-weight:600; }
.metric-desc{ color:var(--muted); font-size:13px; margin-top:6px; }
.spec-list{ margin:0; padding-left:18px; }
.flags{ display:flex; flex-wrap:wrap; gap:8px; }
.flags .tag, .tag{
  display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px;
  background: rgba(255,255,255,.07); border:1px solid rgba(255,255,255,.12); font-size:12px;
}
.tag.ok{ background: rgba(41,199,140,.16); border-color: rgba(41,199,140,.25); }
.tag.warn{ background: rgba(255,178,0,.16); border-color: rgba(255,178,0,.25); }
.tag.danger{ background: rgba(255,99,99,.16); border-color: rgba(255,99,99,.25); }

/* Outfit inline */
.outfit-inline .advice-list{ display:grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap:10px; padding-left:18px; }

/* =========================
   HOURLY / DAILY
   ========================= */
.hourly-grid{
  display:grid; grid-template-columns: repeat(16, minmax(120px,1fr)); gap:10px; overflow-x:auto; padding-bottom:6px;
}
.hour-item{
  background: rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1);
  border-radius: 14px; padding:10px; min-width:120px;
  display:grid; gap:6px; text-align:center;
}
.hour-item .h-time{ color:var(--muted); font-size:12px; }
.hour-item .h-temp{ font-size:20px; font-weight:600; }
.hour-item .h-mini{ display:flex; justify-content:space-between; font-size:12px; color:var(--muted); }
.legend{ margin-top:10px; display:flex; gap:12px; align-items:center; color:var(--muted); font-size:13px; }
.legend .dot{ width:10px; height:10px; border-radius:50%; display:inline-block; }
.legend .temp{ background: #ffb054; }
.legend .rain{ background: #71c7ff; }
.legend .wind{ background: #98ffa6; }

/* Daily list */
.daily-list{ display:grid; gap:10px; }
.day-item{
  display:grid; grid-template-columns: 120px 1fr auto; align-items:center; gap:12px;
  background: rgba(255,255,255,.05); border:1px solid rgba(255,255,255,.1); border-radius:14px; padding:10px;
}
.day-item .day-name{ font-weight:600; }
.day-item .day-range{ color:var(--muted); font-size:13px; }
.day-item .day-extra{ display:flex; gap:10px; color:var(--muted); font-size:13px; }

/* =========================
   CHARTS (fixed overflow)
   ========================= */
.charts{ grid-template-columns: repeat(2, minmax(0,1fr)); }
.charts .card h3{ margin-bottom: 8px; }

/* Card chứa biểu đồ: dùng flex để canvas co giãn đúng tỉ lệ */
.charts article.card{
  min-height: 260px;          /* chiều cao tối thiểu để có không gian cho canvas */
  display: flex;
  flex-direction: column;
}

/* Canvas: lấp đầy không gian trong card, không tràn ra ngoài */
.charts canvas{
  flex: 1;                    /* chiếm phần còn lại của card */
  width: 100%;                /* không vượt chiều ngang */
  max-height: 240px;          /* giới hạn chiều cao để tránh tràn */
  display: block;             /* tránh inline-gap */
  background: rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.08);
  border-radius: 12px;
  box-sizing: border-box;
}

/* =========================
   NEWS
   ========================= */
.news-list{ list-style: none; padding-left:0; margin:0; display:grid; gap:10px; }
.news-item{
  padding:10px; border-radius:12px; background: rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
}
.news-item .title{ font-weight:600; }
.news-item .meta{ color:var(--muted); font-size:12px; margin-top:4px; }

/* =========================
   ASTRONOMY
   ========================= */
.card p{ margin:.2rem 0; }

/* =========================
   FOOTER
   ========================= */
.app-footer{ border-top:1px solid rgba(255,255,255,.08); padding:20px 0 40px; background: linear-gradient(180deg, rgba(0,0,0,.15), transparent); }
.app-footer p{ margin:.35rem 0; }
.app-footer a{ color: var(--accent); text-decoration: none; border-bottom:1px dotted transparent; }
.app-footer a:hover{ border-color: var(--accent); }

/* =========================
   UTILITIES
   ========================= */
.row{ display:flex; gap:10px; align-items:center; }
.row.gap{ gap:12px; }

.hidden{ display:none !important; }
.show{ display:block !important; }
.dot{ color:var(--muted); }
.md\:hidden{ display:none; }

@keyframes fadeUp{
  from{ opacity:0; transform: translateY(6px); }
  to{ opacity:1; transform: translateY(0); }
}

/* =========================
   RESPONSIVE
   ========================= */
@media (max-width: 1100px){
  .metrics{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .cards-4{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .charts{ grid-template-columns: 1fr; }
  .searchbar input{ min-width:220px; }
  .charts article.card{ min-height: 240px; }
  .charts canvas{ max-height: 220px; }
}

@media (max-width: 860px){
  .header-inner{ grid-template-columns: 1fr; }
  .searchbar{ justify-content: stretch; }
  .tabs-nav{ order: 3; }
  .mobile-quick{ display:block; }
  .md\:hidden{ display:inline-grid; }
  .searchbar{ display:none; } /* ẩn ô search desktop, dùng mobile quick */
}

@media (max-width: 720px){
  .cards-3{ grid-template-columns: 1fr; }
  .outfit-inline .advice-list{ grid-template-columns: 1fr; }
  .hourly-grid{ grid-template-columns: repeat(8, minmax(120px,1fr)); }
  .day-item{ grid-template-columns: 1fr; gap:6px; text-align:left; }
  .charts article.card{ min-height: 220px; }
  .charts canvas{ max-height: 200px; }
}

/* =========================
   ACCESSIBILITY FOCUS
   ========================= */
:focus-visible{
  outline:2px solid var(--accent);
  outline-offset: 2px;
  border-radius: 10px;
}

/* =========================
   COLOR TOKENS FOR DATA
   ========================= */
.temp-hot{ color:#ffb054; }
.temp-cold{ color:#6fb1ff; }
.bad{ color:#ff6363; }
.ok{ color:#29c78c; }
.warn{ color:#ffb200; }

/* =========================
   PLACEHOLDER SKELETON (optional)
   ========================= */
.skeleton{
  position:relative; overflow:hidden; background: rgba(255,255,255,.06); border-radius:12px; min-height:16px;
}
.skeleton::after{
  content:""; position:absolute; inset:0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.08), transparent);
  animation: shine 1.2s infinite;
}
@keyframes shine{ from{ transform: translateX(-100%);} to{ transform: translateX(100%);} }
